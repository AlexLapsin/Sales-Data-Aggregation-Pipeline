FROM apache/airflow:2.6.1

# Switch to root if you need OS libraries here
USER root

# (Optional) Install OS dependencies if any
# RUN apt-get update && apt-get install -y <packages> && rm -rf /var/lib/apt/lists/*

# Switch to airflow user to install Python packages
USER airflow

# Install DockerOperator provider and Docker SDK
RUN pip install --no-cache-dir \
    apache-airflow-providers-docker \
    docker